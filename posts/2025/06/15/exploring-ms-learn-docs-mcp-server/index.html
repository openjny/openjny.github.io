<!doctype html><html lang=ja><head><title>Microsoft Learn Docs の公式 MCP サーバーを試す · /etc/openjny
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Junya Yamaguchi (@openjny)"><meta name=description content="Microsoft Learn Docs の公式 MCP サーバーを試してみた結果をまとめました。MCP サーバーの設定方法や、提供される機能、検索スコープなどについて解説します。"><meta name=keywords content="Azure,MCP,LLM"><meta name=twitter:card content="summary"><meta name=twitter:title content="Microsoft Learn Docs の公式 MCP サーバーを試す"><meta name=twitter:description content="Microsoft Learn Docs の公式 MCP サーバーを試してみた結果をまとめました。MCP サーバーの設定方法や、提供される機能、検索スコープなどについて解説します。"><meta property="og:url" content="https://openjny.github.io/posts/2025/06/15/exploring-ms-learn-docs-mcp-server/"><meta property="og:site_name" content="/etc/openjny"><meta property="og:title" content="Microsoft Learn Docs の公式 MCP サーバーを試す"><meta property="og:description" content="Microsoft Learn Docs の公式 MCP サーバーを試してみた結果をまとめました。MCP サーバーの設定方法や、提供される機能、検索スコープなどについて解説します。"><meta property="og:locale" content="ja"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-15T00:00:00+00:00"><meta property="article:modified_time" content="2025-06-15T00:00:00+00:00"><meta property="article:tag" content="MCP"><meta property="article:tag" content="Azure"><meta property="article:tag" content="LLM"><link rel=canonical href=https://openjny.github.io/posts/2025/06/15/exploring-ms-learn-docs-mcp-server/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.140953f60ced76bc313e5d112c66fd4eb9df859f9cbc71a559db3d781dadcc70.css integrity="sha256-FAlT9gztdrwxPl0RLGb9TrnfhZ+cvHGlWds9eB2tzHA=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://openjny.github.io/>/etc/openjny
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>ブログ</a></li><li class=navigation-item><a class=navigation-link href=/tags/>タグ</a></li><li class=navigation-item><a class=navigation-link href=/categories/>カテゴリ</a></li><li class=navigation-item><a class=navigation-link href=/projects/>プロジェクト</a></li><li class=navigation-item><a class=navigation-link href=/about-me/>About Me</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=/en/posts/2025/06/15/exploring-ms-learn-docs-mcp-server/>🇺🇸</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://openjny.github.io/posts/2025/06/15/exploring-ms-learn-docs-mcp-server/>Microsoft Learn Docs の公式 MCP サーバーを試す</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2025-06-15T00:00:00Z>2025年6月15日
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
10分で読めます</span></div><div class=categories><i class="fa-solid fa-folder" aria-hidden=true></i>
<a href=/categories/azure/>Azure</a></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/mcp/>MCP</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/azure/>Azure</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/llm/>LLM</a></span></div></div></header><div class=post-content><p>先日、Microsoft の公式ドキュメントを検索するためのオフィシャル MCP サーバー (Microsoft Learn Docs MCP Server) が公開されました。自分のような Azure ユーザーには大変嬉しい発表です。</p><p><a href=https://github.com/MicrosoftDocs/mcp class=external-link target=_blank rel=noopener>https://github.com/MicrosoftDocs/mcp</a></p><p>ただ、具体的な実装とアーキテクチャは公開されておらず、どんな動作をするのか未知な部分があります。そこで、本記事では Microsoft Learn Docs MCP Server を使ってみてわかったことを少しまとめてみました。</p><p>なお、読者には MCP の基礎知識があることを前提にしています。MCP について知りたい場合は、次のような文献をあたってみてください。</p><ul><li><a href=https://modelcontextprotocol.io/introduction class=external-link target=_blank rel=noopener>Introduction - Model Context Protocol</a></li><li><a href=https://github.com/microsoft/mcp-for-beginners/blob/main/translations/ja/README.md class=external-link target=_blank rel=noopener>mcp-for-beginners/translations/ja/README.md at main · microsoft/mcp-for-beginners</a></li></ul><p>また、Microsoft が提供している MCP サーバーは、Microsoft Learn Docs MCP Server だけではありません。Azure MCP Server など、他のオフィシャル実装も気になる場合は、以下をチェックしてみてください。</p><ul><li><a href=https://github.com/microsoft/mcp class=external-link target=_blank rel=noopener>https://github.com/microsoft/mcp</a></li></ul><h2 id=設定方法>設定方法
<a class=heading-link href=#%e8%a8%ad%e5%ae%9a%e6%96%b9%e6%b3%95><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><p>Microsoft Learn Docs MCP Server を使用するには、Streamable HTTP に対応する MCP クライアントで、エンドポイントに <code>https://learn.microsoft.com/api/mcp</code> を指定します。</p><p>VS Code (GitHub Copilot) では、次のような構成に相当します<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>。</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json:settings.json data-lang=json:settings.json><span style=display:flex><span>    <span style=color:#98c379>&#34;mcp&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;inputs&#34;</span>: [],
</span></span><span style=display:flex><span>        <span style=color:#e06c75>&#34;servers&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#e06c75>&#34;msdocsmicrosoft.docs.mcp&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#e06c75>&#34;type&#34;</span>: <span style=color:#98c379>&#34;http&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e06c75>&#34;url&#34;</span>: <span style=color:#98c379>&#34;https://learn.microsoft.com/api/mcp&#34;</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    },
</span></span></code></pre></div><p>今回は MCP サーバーの動作確認が主な目的なので、クライアントに <a href=https://github.com/modelcontextprotocol/inspector class=external-link target=_blank rel=noopener>MCP Inspector</a> を使いました。MCP サーバーに発行するリクエスト (e.g. 検索キーワード) を設定したり、MCP サーバーからのレスポンス (e.g. 検索にヒットした公式ドキュメント) を閲覧する機能があるため、LLM の非決定的な振る舞い<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>に邪魔されずに検証できます。</p><h2 id=提供される機能>提供される機能
<a class=heading-link href=#%e6%8f%90%e4%be%9b%e3%81%95%e3%82%8c%e3%82%8b%e6%a9%9f%e8%83%bd><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><p>2025/6/21 現在、Microsoft Learn Docs MCP Server が提供する機能 (リソース/プロンプト/ツール) は、<code>microsoft_docs_search</code> ツールのみです。</p><p>このツールは、検索キーワードを入力に受取、それに関連する公式ドキュメントのコンテンツと <strong>英語版</strong>のドキュメント URL<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup> を返却します。以下は、List Tools 実行時に返却される (LLM/エージェントが参照する) ツールの説明文です。</p><blockquote><p>Search official Microsoft/Azure documentation to find the most relevant and trustworthy content for a user&rsquo;s query. This tool returns up to 10 high-quality content chunks (each max 500 tokens), extracted from Microsoft Learn and other official sources. Each result includes the article title, URL, and a self-contained content excerpt optimized for fast retrieval and reasoning. Always use this tool to quickly ground your answers in accurate, first-party Microsoft/Azure knowledge.</p></blockquote><blockquote></blockquote><p>検索を試してみた結果、キーワード検索とセマンティック検索を混ぜ合わせた検索スタイルのようです:</p><ul><li><code>UserErrorGuestAgentStatusUnavailable</code> のようなエラーコードを直接検索キーワードにすると、そのエラーコードが記述されているドキュメントをしっかり拾ってくれます。</li><li><code>Microsoft 365 Copilot のデータ保持ポリシーについて知りたい</code> のような自然言語によるファジーな検索にも対応しています。入力文に関しては、日本語でも英語でも問題ないようなので、最近の言語モデルを使ったセマンティック検索が実装されていると予想されます。</li></ul><h2 id=microsoft_docs_search-の特徴>microsoft_docs_search の特徴
<a class=heading-link href=#microsoft_docs_search-%e3%81%ae%e7%89%b9%e5%be%b4><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><h3 id=レスポンス>レスポンス
<a class=heading-link href=#%e3%83%ac%e3%82%b9%e3%83%9d%e3%83%b3%e3%82%b9><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h3><p>MCP サーバーからのレスポンスは、 最大 10 個のコンテンツ (公式ドキュメントのチャンク) のリストです。以下は、実際のレスポンスの例です。</p><div class=highlight><pre tabindex=0 style=color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>[
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>&#34;title&#34;</span>: <span style=color:#98c379>&#34;Troubleshoot Azure Backup failures caused by agent or extension issues&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e06c75>&#34;content&#34;</span>: <span style=color:#98c379>&#34;# Troubleshoot Azure Backup failures caused by agent or extension issues\n## Step-by-step guide to troubleshoot backup failures\n5. **Ensure the VSS writer service is up and running**: Follow these steps To [Troubleshoot VSS writer issues](https://learn.microsoft.com/en-us/azure/backup/backup-azure-vms-troubleshoot#extensionfailedvsswriterinbadstate---snapshot-operation-failed-because-vss-writers-were-in-a-bad-state).\n6. **Follow backup best practice guidelines**: Review the [best practices to enable Azure VM backup](https://learn.microsoft.com/en-us/azure/backup/backup-azure-vms-introduction#best-practices).\n7. **Review guidelines for encrypted disks**: If you&#39;re enabling backup for VMs with encrypted disk, ensure you&#39;ve provided all the required permissions. To learn more, see [Back up and restore encrypted Azure VM](https://learn.microsoft.com/en-us/azure/backup/backup-azure-vms-encryption).\n## UserErrorGuestAgentStatusUnavailable - VM agent unable to communicate with Azure Backup\n**Error code**: UserErrorGuestAgentStatusUnavailable **Error message**: VM Agent unable to communicate with Azure Backup\nThe Azure VM agent might be stopped, outdated, in an inconsistent state, or not installed. These states prevent the Azure Backup service from triggering snapshots.\n1. **Open Azure portal &gt; VM &gt; Settings &gt; Properties pane** &gt; ensure VM **Status** is **Running** and **Agent status** is **Ready**. If the VM agent is stopped or is in an inconsistent state, restart the agent\n1.1. For Windows VMs, follow these steps to restart the Guest Agent.\n1.2. For Linux VMs, follow these steps to restart the Guest Agent.\n2. **Open Azure portal &gt; VM &gt; Settings &gt; Extensions** &gt; Ensure all extensions are in **provisioning succeeded** state. If not, follow these steps to resolve the issue.&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e06c75>&#34;contentUrl&#34;</span>: <span style=color:#98c379>&#34;https://learn.microsoft.com/en-us/azure/backup/backup-azure-troubleshoot-vm-backup-fails-snapshot-timeout#step-by-step-guide-to-troubleshoot-backup-failures&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>&#34;title&#34;</span>: <span style=color:#98c379>&#34;Troubleshoot Azure Windows VM Agent issues&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e06c75>&#34;content&#34;</span>: <span style=color:#98c379>&#34;# Troubleshoot Azure Windows VM Agent issues\n## Troubleshooting checklist\nFor any VM extension to be able to run, Azure VM Guest Agent must be installed and working successfully. If you see that Guest Agent is reported as **Not ready**, or if an extension is failing and returning an error message such as `VMAgentStatusCommunicationError`, follow these steps to begin troubleshooting Guest Agent.\n### Step 1: Check whether the VM is started\nTo verify that the VM is started, follow these steps:\n1. In the [Azure portal](https://portal.azure.com), search for and select **Virtual machines**.\n2. In the list of VMs, select the name of your Azure VM.\n3. In the navigation pane of your Azure VM, select **Overview**.\n4. If the VM isn&#39;t turned on already, locate the list of actions at the top of the **Overview** page, and then select the **Start** link.\nAlso, verify that the operating system (OS) is started and running successfully.\n### Step 2: Check whether Guest Agent is ready\nWhile you&#39;re still on the VM overview page of the Azure portal, select the **Properties** tab. If the **Agent status** field has a value of **Ready**, verify that the **Agent version** field value satisfies the [minimum supported version](https://learn.microsoft.com/en-us/troubleshoot/azure/virtual-machines/windows/support-extensions-agent-version). The following screenshot shows where you can find these fields.\nIf the Guest Agent status is **Ready** but you have an issue that involves a VM extension, see [Azure virtual machine extensions and features](https://learn.microsoft.com/en-us/azure/virtual-machines/extensions/overview) to review troubleshooting suggestions.\nIf the Guest Agent status is **Not ready** or blank, then either Guest Agent isn&#39;t installed or it isn&#39;t working correctly.\n### Step 3: Check whether the Guest Agent services are running\n1. [Use Remote Desktop Protocol (RDP) to connect to your VM](https://learn.microsoft.com/en-us/azure/virtual-machines/windows/connect-rdp).\n Note\n The Guest Agent isn&#39;t necessary for RDP connectivity to work successfully. If you experience issues that affect RDP connectivity to your VM, see [Troubleshoot Remote Desktop connections to an Azure virtual machine](https://learn.microsoft.com/en-us/troubleshoot/azure/virtual-machines/windows/troubleshoot-rdp-connection).\n2. On your VM, select **Start**, search for *services.msc*, and then select the **Services** app.\n3. In the **Services** window, select the **RdAgent** service.&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e06c75>&#34;contentUrl&#34;</span>: <span style=color:#98c379>&#34;https://learn.microsoft.com/en-us/troubleshoot/azure/virtual-machines/windows/windows-azure-guest-agent#troubleshooting-checklist&#34;</span>
</span></span><span style=display:flex><span>  },
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    <span style=color:#e06c75>&#34;title&#34;</span>: <span style=color:#98c379>&#34;Troubleshoot Azure Windows VM Agent issues&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e06c75>&#34;content&#34;</span>: <span style=color:#98c379>&#34;# Troubleshoot Azure Windows VM Agent issues\n## Troubleshooting checklist\n4. Select the **Action** menu, and then select **Properties**.\n5. On the **General** tab of the **Properties** dialog box, make sure that the following conditions are true, and then select the **OK** or **Cancel** button:\n5.1. The **Startup type** drop-down list is set to **Automatic**.\n5.2. The **Service status** field has a value of **Running**.\n6. In the **Services** window, select the **WindowsAzureGuestAgent** service.\n7. Repeat steps 4 and 5.\nIf the services don&#39;t exist, the Guest Agent probably isn&#39;t installed. In this case, you can [manually install the Guest Agent](https://learn.microsoft.com/en-us/azure/virtual-machines/extensions/agent-windows#manual-installation). Before you do a manual installation, [check the installation prerequisites](https://learn.microsoft.com/en-us/azure/virtual-machines/extensions/agent-windows#prerequisites).\n### Step 4: Test WireServer connectivity\nTo run successfully, Guest Agent requires connectivity to the WireServer IP (host IP) address `168.63.129.16` on ports `80` and `32526`. For instructions about how to test connectivity to this IP address, see the [Troubleshoot connectivity](https://learn.microsoft.com/en-us/azure/virtual-network/what-is-ip-address-168-63-129-16#troubleshoot-connectivity) section of [What is IP address 168.63.129.16?](https://learn.microsoft.com/en-us/azure/virtual-network/what-is-ip-address-168-63-129-16)\nIf any of the tests in that section don&#39;t connect, check for issues that might cause any of the following components to block access to IP address `168.63.129.16`:\n1. A firewall\n2. A proxy\n3. An application\n### Step 5: Review log files\nCheck the following log locations for any notable errors:\n1. *C:\\WindowsAzure\\Logs\\WaAppAgent.log*\n2. *C:\\WindowsAzure\\Logs\\TransparentInstaller.log*\nCompare any errors that you find to the following common scenarios that can cause the Azure VM Agent to show a **Not ready** status or stop working as expected.&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e06c75>&#34;contentUrl&#34;</span>: <span style=color:#98c379>&#34;https://learn.microsoft.com/en-us/troubleshoot/azure/virtual-machines/windows/windows-azure-guest-agent#troubleshooting-checklist&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#7f848e>// ...
</span></span></span><span style=display:flex><span><span style=color:#7f848e></span>]
</span></span></code></pre></div><p>返却されたコンテンツがクライアント (LLM/エージェント) で取り扱いやすいように、次のような工夫が施されています。</p><ul><li>ドキュメントのタイトルと URL が必ず含まれる。</li><li>Markdown 形式で記述されている (ドキュメントの構造が保持される)。</li><li>コンテンツが見出し (h1 や h2) から始まるように分割されている。</li></ul><p>コンテンツは、<strong>関連度順 (最も関連するものが先頭に来るよう) にソートされています</strong><sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>。クライアントで調整できる場合は、先頭のものを優先的に使用すると良いでしょう<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>。</p><h3 id=検索スコープ>検索スコープ
<a class=heading-link href=#%e6%a4%9c%e7%b4%a2%e3%82%b9%e3%82%b3%e3%83%bc%e3%83%97><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h3><p>GitHub ページでは、検索対象のコンテンツは Microsoft Learn、Azure ドキュメント、M365 ドキュメント、その他の Microsoft のリソースと記述されています。</p><blockquote><p>Microsoft Learn, Azure documentation, Microsoft 365 documentation, and other official Microsoft sources.
<a href="https://github.com/MicrosoftDocs/mcp?tab=readme-ov-file#-key-capabilities" class=external-link target=_blank rel=noopener>https://github.com/MicrosoftDocs/mcp?tab=readme-ov-file#-key-capabilities</a></p></blockquote><p>実際にどの程度カバーできてるのか、簡単に実験してみます。具体的には、<a href=https://learn.microsoft.com/en-us/docs/ class=external-link target=_blank rel=noopener>製品ディレクトリ</a> から、サービスをいくつかピックアップします。サービスごとに適当な公式ドキュメント ページを選定し、サービス名とページ タイトルを <code>query</code> に設定して <code>microsoft_docs_search</code> を実行します。そして、レスポンスにその製品の URL が含まれていれば、サービスが検索に対応していると判断します。</p><pre tabindex=0><code class=language-json:query data-lang=json:query>{ &#34;query&#34;: &#34;Dynamics 365: Integration overview for Business Central (for architects and developers)&#34; }
</code></pre><p>結果は、次の通りとなりました。</p><table><thead><tr><th style=text-align:left>サービス</th><th style=text-align:left>サービスのドキュメント URL</th><th style=text-align:left>結果 (対応可否)</th></tr></thead><tbody><tr><td style=text-align:left>.NET</td><td style=text-align:left><a href=https://learn.microsoft.com/en-us/dotnet/ class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/dotnet/</a></td><td style=text-align:left>✅</td></tr><tr><td style=text-align:left>Azure</td><td style=text-align:left><a href=https://learn.microsoft.com/en-us/azure/ class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/azure/</a></td><td style=text-align:left>✅</td></tr><tr><td style=text-align:left>Azure > Azure Architecture Center</td><td style=text-align:left><a href=https://learn.microsoft.com/en-us/azure/architecture/ class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/azure/architecture/</a></td><td style=text-align:left>✅</td></tr><tr><td style=text-align:left>Azure > Cloud Adoption Framework</td><td style=text-align:left><a href=https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/</a></td><td style=text-align:left>✅</td></tr><tr><td style=text-align:left>Azure > Well-Architected Framework</td><td style=text-align:left><a href=https://learn.microsoft.com/en-us/azure/well-architected/ class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/azure/well-architected/</a></td><td style=text-align:left>✅</td></tr><tr><td style=text-align:left>Azure CLI</td><td style=text-align:left><a href=https://learn.microsoft.com/en-us/cli/ class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/cli/</a></td><td style=text-align:left>✅</td></tr><tr><td style=text-align:left>C++</td><td style=text-align:left><a href=https://learn.microsoft.com/en-us/cpp/ class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/cpp/</a></td><td style=text-align:left>✅</td></tr><tr><td style=text-align:left>Dynamics 365</td><td style=text-align:left><a href=https://learn.microsoft.com/en-us/dynamics365/ class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/dynamics365/</a></td><td style=text-align:left>✅</td></tr><tr><td style=text-align:left>Microsoft Graph</td><td style=text-align:left><a href=https://learn.microsoft.com/en-us/graph/ class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/graph/</a></td><td style=text-align:left>✅</td></tr><tr><td style=text-align:left>Microsoft 365</td><td style=text-align:left><a href=https://learn.microsoft.com/en-us/microsoft-365/ class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/microsoft-365/</a></td><td style=text-align:left>✅</td></tr><tr><td style=text-align:left>Microsoft 365 Copilot</td><td style=text-align:left><a href=https://learn.microsoft.com/en-us/microsoft-copilot-service/ class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/microsoft-copilot-service/</a></td><td style=text-align:left>✅</td></tr><tr><td style=text-align:left>PowerShell</td><td style=text-align:left><a href=https://learn.microsoft.com/en-us/powershell/ class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/powershell/</a></td><td style=text-align:left>✅</td></tr><tr><td style=text-align:left>Training</td><td style=text-align:left><a href=https://learn.microsoft.com/en-us/training/ class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/training/</a></td><td style=text-align:left>✅</td></tr><tr><td style=text-align:left>Windows</td><td style=text-align:left><a href=https://learn.microsoft.com/en-us/windows/ class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/windows/</a></td><td style=text-align:left>✅</td></tr><tr><td style=text-align:left>Windows Server</td><td style=text-align:left><a href=https://learn.microsoft.com/en-us/windows-server/ class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/windows-server/</a></td><td style=text-align:left>✅</td></tr></tbody></table><p>検証したサービスはすべて検索可能だったので、かなり広域なコンテンツがカバーされているだろうと考えられます。</p><p>Azure 関連で言えば、アーキテクチャセンター、Well-Architected Framework (WAF)、Could Adoption Framework (CAF) が対象に含まれているのが嬉しいです。例えば、<code>ミッションクリティカルな Azure システムのベストプラクティス</code> のように雑にクエリを投げても、次のような URL からコンテンツを取って来てくれます。</p><ul><li><a href=https://learn.microsoft.com/en-us/azure/well-architected/mission-critical/mission-critical-operational-procedures#application-operations class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/azure/well-architected/mission-critical/mission-critical-operational-procedures#application-operations</a></li><li><a href=https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/containers/aks-mission-critical/mission-critical-operations class=external-link target=_blank rel=noopener>https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/containers/aks-mission-critical/mission-critical-operations</a></li></ul><h3 id=更新の反映スピード>更新の反映スピード
<a class=heading-link href=#%e6%9b%b4%e6%96%b0%e3%81%ae%e5%8f%8d%e6%98%a0%e3%82%b9%e3%83%94%e3%83%bc%e3%83%89><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h3><p>GitHub のページでは、「最新の情報が取得できる」と記述されています。</p><blockquote><ul><li><strong>Real-time Updates</strong>: Access the latest Microsoft documentation as it&rsquo;s published.</li></ul></blockquote><p>一般に、検索エンジンは前処理したコンテンツを検索対象とするため、真に最新のコンテンツが検索できるとは限りません。たとえば、流行りの文書埋め込みによるセマンティック検索なんかでは、検索対象のチャンク化とインデックス化の前処理が必要です。</p><p>そこで、どこまで最新の情報が取れるのか確認してみます。GitHub 上の更新履歴を見ると、ドキュメントでの反映が確認できた最新の更新が以下のコミットでした。これは、確認の <strong>14 時間前</strong> に加わったドキュメント更新です。</p><p><a href=https://github.com/MicrosoftDocs/azure-docs/commit/0dd0229ee18e326a7788f260102316fd3933b240 class=external-link target=_blank rel=noopener>https://github.com/MicrosoftDocs/azure-docs/commit/0dd0229ee18e326a7788f260102316fd3933b240</a></p><p><code>OpenPBS Integration: OpenPBS scheduler configuration in Azure CycleCloud</code> で検索すると、ディスクサイズが 20g にハードコーディングされている、みたいな趣旨の内容が含まれていました。CycleCloud は何もしりませんが、そうなんだろうという感じです。</p><figure><img src=/posts/2025/06/15/exploring-ms-learn-docs-mcp-server/index-speed-01.png alt=検索結果><figcaption><p>検索結果</p></figcaption></figure><p>これは、14 時間前に更新されたコンテンツと一致しています。</p><figure><img src=/posts/2025/06/15/exploring-ms-learn-docs-mcp-server/index-speed-02.png alt="更新後 (右側) のコンテンツが検索結果と一致"><figcaption><p>更新後 (右側) のコンテンツが検索結果と一致</p></figcaption></figure><p>したがって、少なくとも 14 時間前の更新であれば、検索に反映されていることがわかりました。厳密なインデックス更新のレイテンシは分からないものの、実用上十分短いレイテンシであるものと考えられます。</p><h2 id=動作例-github-copilot>動作例: GitHub Copilot
<a class=heading-link href=#%e5%8b%95%e4%bd%9c%e4%be%8b-github-copilot><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><p>GitHub Copilot のエージェントモードで <code>microsoft_docs_search</code> を使用した場合の動作例を紹介します。</p><p>Bicep コードが含まれるレポジトリ上で、Bicep のベストプラクティスを調べてみます。この質問をした後、Bicep コードを記述するための GitHub Copilot インストラクション (.github/instructions/&mldr;) を作ってもらう想定です。</p><p>まずは、素の GitHub Copilot<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup> を使った際の回答です。</p><figure><img src=/posts/2025/06/15/exploring-ms-learn-docs-mcp-server/demo-01.png alt="素の GitHub Copilot の回答"><figcaption><p>素の GitHub Copilot の回答</p></figcaption></figure><p>使用したモデル <code>GPT-4.1</code> は、カットオフ日が 2024/6 と比較的新しいため、それなりの回答を作ってくれました。ですが、インストラクションに変換したいかと言われると微妙です。</p><p>続いて、<a href=https://learn.microsoft.com/ja-jp/azure/developer/github-copilot-azure/introduction class=external-link target=_blank rel=noopener>GitHub Copilot for Azure</a> を使って回答を生成してみます。GitHub Copilot for Azure は、自分の Azure リソースにアクセスしてコンテキストを付与するための GitHub Copilot 向け拡張機能ですが、簡易的に Azure ドキュメントを検索する <code>azure_query_learn</code> ツールを備えます。ここでは、そのツールを呼び出して同じ質問をします。</p><figure><img src=/posts/2025/06/15/exploring-ms-learn-docs-mcp-server/demo-02.png alt="GitHub Copilot for Azure の回答"><figcaption><p>GitHub Copilot for Azure の回答</p></figcaption></figure><p>グラウンディングできている点は先程よりも一歩前進ですが、自分が期待する回答とほど遠い結果となりました。サーバーとのやり取りを見ると、レスポンスに含まれるコンテンツ ページが一つだけだったので、取得できる情報の少なさがボトルネックのようです。</p><p>最後に、<code>microsoft_docs_search</code> を使用して回答を生成してみます。</p><figure><img src=/posts/2025/06/15/exploring-ms-learn-docs-mcp-server/demo-03.png alt="GitHub Copilot x MCP (microsoft_docs_search) の回答"><figcaption><p>GitHub Copilot x MCP (microsoft_docs_search) の回答</p></figcaption></figure><p>見切れてしまっていますが、10 件の関連ドキュメントによる回答なので詳細な部分まで踏み込んだ説明になっています。試したシナリオの中では最も期待する回答に近いものが得られました。</p><h2 id=まとめ>まとめ
<a class=heading-link href=#%e3%81%be%e3%81%a8%e3%82%81><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><p>本記事では、Microsoft Learn Docs の公式 MCP サーバー (Microsoft Learn Docs MCP Server) が提供する <code>microsoft_docs_search</code> ツールの検証を通して、次のような特徴があることを確認しました。</p><ul><li><strong>高精度な検索能力</strong>: エラーコードのような具体的なキーワードから、「Microsoft 365 Copilot のデータ保持ポリシーについて知りたい」といった自然言語によるファジーなクエリまで、どちらも高い精度で関連性の高いドキュメントを抽出できました。キーワード検索とセマンティック検索を組み合わせた、最新の検索エンジンに近い挙動をしていると考えられます。</li><li><strong>LLM に最適化されたコンテンツ形式</strong>: 検索結果は、タイトルと URL を含む Markdown 形式のコンテンツ チャンクとして提供されます。各チャンクはドキュメントの見出しから始まり、LLM が扱いやすいように工夫されています。返却されるコンテンツは関連度順にソートされているように見え、これは RAG システムにおける情報の利用効率を高めるのに役立つでしょう。</li><li><strong>広範なドキュメントの網羅</strong>: Azure、Microsoft 365、Windows、.NET、Dynamics 365 など、Microsoft の主要な公式ドキュメントが幅広く検索対象に含まれていることを確認しました。特に Azure のアーキテクチャ関連ドキュメント（Azure Architecture Center, Well-Architected Framework, Cloud Adoption Framework）がカバーされているのは、Azure ユーザーにとって大きなメリットです。</li><li><strong>迅速な情報反映</strong>: GitHub でのドキュメント更新から少なくとも 14 時間後には、その内容が MCP サーバーの検索結果に反映されていることを確認しました。これにより、常に最新の公式情報を参照できることが期待できます。</li></ul><p><a href=https://learn.microsoft.com/en-us/microsoft-copilot-studio/agent-extend-action-mcp#supported-transports class=external-link target=_blank rel=noopener>M365 Copilot エージェントも Streamable HTTP に対応</a>していますし、Microsoft Learn Docs MCP Server を手軽に使えるクライアントは増えてきています。これからどんな活用事例が生まれてくるのか、非常に楽しみです。</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://code.visualstudio.com/updates/v1_100#_mcp-support-for-streamable-http class=external-link target=_blank rel=noopener>https://code.visualstudio.com/updates/v1_100#_mcp-support-for-streamable-http</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>MCP サーバーにどんな要求を渡すか、サーバーからのレスポンスをどう回答に盛り込むかは、LLM やエージェントの動作依存です。早速、https://github.com/MicrosoftDocs/mcp/issues/6 で類似事象が報告されてました。&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>ドキュメントの更新もオリジナルである英語版が最も早いので、参照されるドキュメントが英語なのはありがたいです。&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a href=https://github.com/MicrosoftDocs/mcp/issues/7#issuecomment-2974973248 class=external-link target=_blank rel=noopener>https://github.com/MicrosoftDocs/mcp/issues/7#issuecomment-2974973248</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p>Lost in the Middle で代表されるように、RAG システムでは情報の埋め込み位置（順番）によって精度が変化する可能性が指摘されています。&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p>Built-in ツールは有効化しています: <a href=https://code.visualstudio.com/docs/copilot/reference/copilot-vscode-features#_chat-variables class=external-link target=_blank rel=noopener>https://code.visualstudio.com/docs/copilot/reference/copilot-vscode-features#_chat-variables</a>&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2024 -
2025
Junya Yamaguchi (@openjny)
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "0a99e4ebb1e342beb03db419a6eea4a6"}'></script></body></html>